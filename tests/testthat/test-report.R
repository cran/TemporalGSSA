#usethis::use_testthat()
#usethis::use_test("report")

valid <- matrix(c(4.99592056104662E-19,499995,500003,52076,856074,408144,408147,213587,305440,305446,305445,1039792,9.0895286250952E-19,499992,500000,29946,842290,372229,372231,4384,132154,132160,132167,1097848,5.66871925230001E-19,499989,500008,43979,856199,400171,400175,177259,277086,277096,277095,1055869,9.13431925017368E-19,499997,499999,30174,842560,372728,372730,22234,128214,128213,128214,1097112,6.66856629255775E-19,499997,500007,36194,853340,389533,389529,124479,234948,234950,234950,1074288,9.18748453328027E-19,499998,500001,29951,841897,371842,371845,466464,128159,128156,128159,1098219,6.33923848260308E-19,499996,499997,38414,854111,392517,392523,141620,249102,249102,249106,1069085,6.61025475380139E-19,499995,500004,36842,852757,389594,389595,127161,237566,237572,237572,1073574,6.46404578600321E-19,499997,499993,37546,853998,391541,391543,134830,243289,243287,243290,1070928,8.71251875548091E-19,499995,500002,30238,844659,374894,374894,23273,148382,148384,148386,1094886,6.42456762267738E-19,499994,500001,37659,854377,392030,392032,137247,245215,245219,245221,1070325,6.50000982450828E-19,499997,500002,37403,853794,391193,391195,132931,241735,241744,241741,1071411,6.51703301709049E-19,499996,500000,37294,853141,390431,390434,132095,241663,241666,241664,1072285,9.19733238113478E-19,499997,499998,29641,842522,372160,372162,74747,128165,128167,128168,1098208,8.8945111346424E-19,499999,499998,29956,844208,374158,374163,14760,140602,140598,140602,1095898,6.55496374724788E-19,499994,499999,37078,853792,390867,390867,129538,238669,238673,238673,1072070,6.40478506078292E-19,499997,499993,38083,854148,392221,392220,138163,245947,245945,245954,1069723,8.46044969800135E-19,499996,500004,30517,845908,376418,376424,34899,158483,158480,158477,1093077,9.19232350704206E-19,499994,500002,29541,842618,372151,372156,64364,127850,127852,127852,1098330,9.05290488116942E-19,499999,500002,30116,843048,373157,373161,858885,133256,133260,133258,1096737,9.0739154712218E-19,499990,500005,29854,843198,373043,373049,4709,131663,131673,131675,1097125,9.18051289626637E-19,499995,499999,29866,841910,371768,371769,63232,128229,128235,128241,1098386,9.18014676040227E-19,499996,500000,29956,842427,372378,372384,37733,127620,127621,127618,1097675,8.99677088174691E-19,499993,500003,29947,842729,372672,372673,8741,136069,136075,136076,1097396,9.08400495196285E-19,499992,500009,29926,843132,373051,373055,4843,131792,131799,131796,1097043,9.17671540274208E-19,499996,499999,29855,842155,372001,372007,97878,128919,128919,128921,1098164,9.15629173860131E-19,499995,500001,30161,842024,372181,372183,255,128075,128079,128081,1097681,9.18787494819808E-19,500000,500003,30059,842445,372498,372502,758505,127500,127502,127503,1097454,9.19961013729775E-19,499999,500007,29565,842688,372249,372251,657849,127746,127748,127745,1098192,9.17770058854612E-19,499998,500000,29852,841831,371681,371686,5363,128318,128316,128317,1098480),byrow=TRUE,nrow=30)

nvalid <- matrix(c(4.99592056104662E-19,499995,500003,52076,856074,408144,408147,213587,305440,305446,305445,1039792,9.0895286250952E-19,499992,500000,29946,842290,372229,372231,4384,132154,132160,132167,1097848,5.66871925230001E-19,499989,500008,43979,856199,400171,400175,177259,277086,277096,277095,1055869,9.13431925017368E-19,499997,499999,30174,842560,372728,372730,22234,128214,128213,128214,1097112),byrow=TRUE,nrow=4)



testthat::test_that("Algorithm is working.....", {
rates_1 <- calculate_TemporalGSSA(valid,3)  
expect_equal(rates_1,0)
})


testthat::test_that("Algorithm is working.....", {
rates_2 <- calculate_TemporalGSSA(valid)  
expect_equal(rates_2,1)
})


testthat::test_that("Algorithm is working.....", {
rates_3 <- calculate_TemporalGSSA(3)  
expect_equal(rates_3,1)
})


testthat::test_that("Algorithm is working.....", {
rates_4 <- calculate_TemporalGSSA()  
expect_equal(rates_4,1)
})

testthat::test_that("Algorithm is working.....", {
rates_5 <- calculate_TemporalGSSA(nvalid,2)  
expect_equal(rates_5,1)
})

testthat::test_that("Algorithm is working.....", {
rates_6 <- calculate_TemporalGSSA(nvalid)  
expect_equal(rates_6,1)
})


